<UserControl xmlns="https://github.com/avaloniaui"
			 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
			 xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
			 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
			 xmlns:converters="clr-namespace:WateryTart.Core.Converters"
			 xmlns:vm="clr-namespace:WateryTart.Core.ViewModels"
			 xmlns:app="clr-namespace:WateryTart.Core"
			 xmlns:behaviors="clr-namespace:WateryTart.Core.Behaviors"
			 xmlns:asyncImageLoader="clr-namespace:AsyncImageLoader;assembly=AsyncImageLoader.Avalonia"
			 mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
			 x:Class="WateryTart.Core.Views.PlaylistsView"
			 x:DataType="vm:PlaylistsViewModel">
	<UserControl.Resources>
		<converters:MetadataImageConverter x:Key="MetadataImageConverter" />
	</UserControl.Resources>
	
	<DockPanel>
		<ListBox x:Name="lbPlaylists" ItemsSource="{Binding Playlists}" Background="Transparent">
			<Interaction.Behaviors>
				<behaviors:GridScrollBehavior 
					LoadMoreCommand="{Binding LoadMoreCommand}"
					IsLoading="{Binding IsLoading}"
					HasMoreItems="{Binding HasMoreItems}" />
			</Interaction.Behaviors>
			<ListBox.ItemsPanel>
				<ItemsPanelTemplate>
					<WrapPanel ItemWidth="200" ItemSpacing="15" />
				</ItemsPanelTemplate>
			</ListBox.ItemsPanel>
			<ListBox.ItemTemplate>
				<DataTemplate>
					<StackPanel>
						<Interaction.Behaviors>
							<EventTriggerBehavior EventName="Tapped">
								<InvokeCommandAction
									Command="{Binding #lbPlaylists.((vm:PlaylistsViewModel)DataContext).ClickedCommand}"
									CommandParameter="{Binding Path=.}"/>
							</EventTriggerBehavior>
						</Interaction.Behaviors>
						<Border BoxShadow="0 0 10 0 Black"
								Margin="0,0,0,5"
								Width="195"
								Height="195">
							<Border ClipToBounds="True"
									CornerRadius="5">
								<asyncImageLoader:AdvancedImage
									Loader="{x:Static app:App.ImageLoaderInstance}"
									Height="195" 
									Width="195" 
									FallbackImage="{x:Static app:App.FallbackImage}"
									Source="{Binding Path=Playlist, Converter={StaticResource MetadataImageConverter}}" />
							</Border>
						</Border>
						<TextBlock Margin="-10,0,0,0" 
								   Text="{Binding Playlist.Name}" 
								   TextTrimming="CharacterEllipsis" 
								   FontWeight="SemiBold" />
					</StackPanel>
				</DataTemplate>
			</ListBox.ItemTemplate>
		</ListBox>
	</DockPanel>
</UserControl>