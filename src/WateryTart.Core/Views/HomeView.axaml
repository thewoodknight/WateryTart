<UserControl
          x:Class="WateryTart.Core.Views.HomeView"
          xmlns="https://github.com/avaloniaui"
          xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
          xmlns:app="clr-namespace:WateryTart.Core"
          xmlns:asyncImageLoader="clr-namespace:AsyncImageLoader;assembly=AsyncImageLoader.Avalonia"
          xmlns:converters="clr-namespace:WateryTart.Core.Converters"
          xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
          xmlns:iconPacks="https://github.com/MahApps/IconPacks.Avalonia"
          xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
          xmlns:vm="clr-namespace:WateryTart.Core.ViewModels"
          d:DesignHeight="450"
          d:DesignWidth="800"
          x:DataType="vm:HomeViewModel"
          mc:Ignorable="d">
    <UserControl.Resources>
        <converters:MetadataImageConverter x:Key="MetadataImageConverter" />
        <converters:ToUpperValueConverter x:Key="ToUpperValueConverter" />
        <converters:HomeExtraToStringConverter x:Key="HomeExtraToStringConverter" />
    </UserControl.Resources>
    <UserControl.Styles>
        <!--  This cascades to all children  -->
        <Style Selector="#lbRecommendations ContentPresenter#PART_ContentPresenter:pointerover">
            <Setter Property="Background" Value="Transparent" />
        </Style>

        <Style Selector="ListBoxItem:selected /template/ ContentPresenter">
            <Setter Property="Background" Value="Transparent" />
        </Style>

        <!--  this 'undoes' the cascading  -->
        <Style Selector="ListBox.hoverable ContentPresenter#PART_ContentPresenter:pointerover">
            <Setter Property="Background" Value="#11FFFFFF" />
        </Style>
    </UserControl.Styles>

    <Grid>

        <!--  Recommendations List  -->
        <ListBox
                  x:Name="lbRecommendations"
                  Background="Transparent"
                  ItemsSource="{Binding Recommendations}">
            <ListBox.GestureRecognizers>
                <ScrollGestureRecognizer CanVerticallyScroll="True" />
            </ListBox.GestureRecognizers>
            <ListBox.ItemTemplate>
                <DataTemplate>
                    <StackPanel>
                        <Border
                                  Background="Transparent"
                                  BorderBrush="#66FFFFFF"
                                  BorderThickness="0,0,0,1">
                            <Interaction.Behaviors>
                                <EventTriggerBehavior EventName="Tapped">
                                    <InvokeCommandAction Command="{Binding #lbRecommendations.((vm:HomeViewModel)DataContext).RecommendationListCommand}" CommandParameter="{Binding Path=.}" />
                                </EventTriggerBehavior>
                            </Interaction.Behaviors>
                            <Grid>
                                <TextBlock
                                          VerticalAlignment="Center"
                                          FontSize="16"
                                          FontWeight="Bold"
                                          Text="{Binding Title, Converter={StaticResource ToUpperValueConverter}}" />
                                <iconPacks:PackIconMaterial
                                          Width="18"
                                          Height="18"
                                          HorizontalAlignment="Right"
                                          Kind="ChevronRight" />
                            </Grid>
                        </Border>

                        <ItemsControl
                                  Padding="0"
                                  Background="{x:Null}"
                                  Classes="hoverable"
                                  ItemsSource="{Binding Items}">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <VirtualizingStackPanel />
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                            <ItemsControl.DataTemplates>
                                <StaticResource ResourceKey="smallViewSelector" />
                            </ItemsControl.DataTemplates>
                        </ItemsControl>
                    </StackPanel>
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>
    </Grid>
</UserControl>
